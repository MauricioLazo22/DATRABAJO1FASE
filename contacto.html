<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>C.D. Talentos Arequipa | Contacto</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

  <link rel="stylesheet" href="css/estilos.css">
  <link rel="stylesheet" href="css/tabla.css">
</head>
<body>
  <a class="skip-link" href="#contenido">Saltar al contenido</a>

  <header class="topbar">
    <nav class="navline container" aria-label="Principal">
      <ul class="nav-left">
        <li><a href="index.html">Inicio</a></li>
        <li><a href="voley.html">V√≥ley</a></li>
      </ul>

      <a class="brand-center" href="index.html" aria-label="C.D. Talentos Arequipa">
        <img src="img/logoTalentosAQP.jpg" alt="Logo C.D. Talentos Arequipa">
      </a>

      <ul class="nav-right">
        <li><a href="contacto.html" aria-current="page">Contacto</a></li>
        <li><a href="https://www.facebook.com/cdtalentosarequipa" target="_blank" rel="noopener">Facebook</a></li>
      </ul>
    </nav>
  </header>

  <main id="contenido" class="container">
    <section class="contact-hero" aria-label="Encabezado de contacto">
      <h1>Cont√°ctanos</h1>
      <nav class="breadcrumb" aria-label="Ruta">
        <a href="index.html">Inicio</a> ¬∑ <span>Contacto</span>
      </nav>
    </section>

    <section class="contact-grid">
      <article class="panel info-card">
        <h2>¬°Juntos hacemos grande el v√≥ley! üèê</h2>
        <p>Con√©ctate con nosotros. Entrenamos en nuestra sede √∫nica:</p>

        <ul class="info-list">
          <li>
            <span class="ic">üìç</span>
            <div>
              <strong>Direcci√≥n</strong><br>
              Don Bosco 405, Cercado ‚Äî Arequipa
            </div>
          </li>
          <li>
            <span class="ic">‚è∞</span>
            <div>
              <strong>Horario</strong><br>
              <u>Lunes a viernes</u>, 4:00 p.m. ‚Äì 8:30 p.m.
            </div>
          </li>
          <li>
            <span class="ic">üë§</span>
            <div>
              <strong>Contacto</strong><br>
              Jos√© Adolfo S√°nchez Calle
            </div>
          </li>
          <li>
            <span class="ic">üì±</span>
            <div>
              <strong>Tel√©fono/WhatsApp</strong><br>
              913 162 985
            </div>
          </li>
          <li>
            <span class="ic">‚úâÔ∏è</span>
            <div>
              <strong>Correo</strong><br>
              <a href="mailto:claudiajoseadolfo12@gmail.com">claudiajoseadolfo12@gmail.com</a>
            </div>
          </li>
          <li>
            <span class="ic">üìò</span>
            <div>
              <strong>Facebook</strong><br>
              <a href="https://www.facebook.com/cdtalentosarequipa" target="_blank" rel="noopener">
                C.D. Talentos Arequipa
              </a>
            </div>
          </li>
        </ul>
      </article>

      <article class="panel form-card" aria-label="Formulario de contacto">
        <form id="contactForm">
          <div class="form-grid">
            <label>
              <span>Nombres</span>
              <input class="input" type="text" name="nombres" placeholder="Nombres completos" required minlength="3">
            </label>
            <label>
              <span>Apellidos</span>
              <input class="input" type="text" name="apellidos" placeholder="Apellidos completos" required minlength="3">
            </label>

            <label>
              <span>Correo</span>
              <input class="input" type="email" name="email" placeholder="ivanGamer@correito.com" required>
            </label>
            <label>
              <span>Tel√©fono</span>
              <input class="input" type="tel" name="telefono" placeholder="9XXXXXXXX" required
                     inputmode="numeric" pattern="^\d{9}$" minlength="9" maxlength="9"
                     title="Debe tener exactamente 9 d√≠gitos (0‚Äì9)">
            </label>

            <label class="form-full">
              <span>Mensaje</span>
              <textarea class="input textarea" name="mensaje" rows="5" placeholder="Escribe tu consulta..." required minlength="10"></textarea>
            </label>
          </div>

          <button class="btn btn-wide btn-primary" type="submit">‚úâÔ∏è Enviar mensaje</button>
          <div id="alertBox" aria-live="polite" class="visually-hidden"></div>
        </form>
      </article>
    </section>

    <section class="panel" id="registros" aria-labelledby="registros-title" style="margin-top:24px">
      <h2 id="registros-title" class="mb-2">Registros enviados</h2>

      <div class="table-tools d-flex flex-wrap gap-2 my-2">
        <input id="busqueda" type="search" class="form-control" placeholder="Buscar por nombre o correo‚Ä¶" style="max-width:320px;">
        <button id="btnExport" type="button" class="btn btn-success btn-sm">Exportar JSON</button>
        <button id="btnClear" type="button" class="btn btn-danger btn-sm">Borrar todos</button>
      </div>

      <div class="table-responsive shadow-sm rounded-3">
        <table class="table table-striped table-hover align-middle mb-0" aria-describedby="tabla-desc">
          <caption id="tabla-desc" class="visually-hidden">Listado de contactos almacenados (LocalStorage del navegador)</caption>
          <thead class="table-light">
            <tr>
              <th>#</th>
              <th>Nombres</th>
              <th>Apellidos</th>
              <th>Correo</th>
              <th>Tel√©fono</th>
              <th>Mensaje</th>
              <th class="text-end">Acciones</th>
            </tr>
          </thead>
          <tbody id="tablaBody"></tbody>
        </table>
      </div>
    </section>
  </main>

  <footer class="container" style="padding:24px 16px">
    <small>¬© 2025 ¬∑ C.D. Talentos Arequipa</small>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

  <script>
    (function () {
      const LS_KEY = "talentos_contacto_registros";

      const $form = document.getElementById("contactForm");
      const $alert = document.getElementById("alertBox");
      const $tbody = document.getElementById("tablaBody");
      const $search = document.getElementById("busqueda");
      const $btnClear = document.getElementById("btnClear");
      const $btnExport = document.getElementById("btnExport");

      const uid = () => Date.now().toString(36) + Math.random().toString(36).slice(2);
      const getData = () => JSON.parse(localStorage.getItem(LS_KEY) || "[]");
      const setData = (arr) => localStorage.setItem(LS_KEY, JSON.stringify(arr));

      function showAlert(text) {
        if (!$alert) return;
        $alert.textContent = text;
        $alert.classList.remove("visually-hidden");
        setTimeout(() => $alert.classList.add("visually-hidden"), 2200);
      }

      const $tel = $form.querySelector('input[name="telefono"]');
      $tel.addEventListener('input', () => {
        $tel.value = $tel.value.replace(/\D/g, '').slice(0, 9);
      });

      function renderTable(query = "") {
        const data = getData();
        const q = query.trim().toLowerCase();
        const filtered = q ? data.filter(r =>
          (r.nombres || "").toLowerCase().includes(q) ||
          (r.email || "").toLowerCase().includes(q)
        ) : data;

        $tbody.innerHTML = filtered.map((r, i) => `
          <tr>
            <td class="num">${i + 1}</td>
            <td class="nowrap-ellipsis" title="${(r.nombres || "").replace(/"/g,'&quot;')}">${r.nombres || ""}</td>
            <td class="nowrap-ellipsis" title="${(r.apellidos || "").replace(/"/g,'&quot;')}">${r.apellidos || ""}</td>
            <td class="nowrap-ellipsis" title="${(r.email || "").replace(/"/g,'&quot;')}">${r.email || ""}</td>
            <td class="nowrap-ellipsis" title="${(r.telefono || "").replace(/"/g,'&quot;')}">${r.telefono || ""}</td>
            <td class="mensaje">
              <div class="msg-snippet" title="${(r.mensaje || "").replace(/"/g,'&quot;')}">
                ${r.mensaje || ""}
              </div>
            </td>
            <td class="text-end">
              <button class="btn btn-outline-danger btn-sm" data-action="delete" data-id="${r.id}">Eliminar</button>
            </td>
          </tr>
        `).join("");
      }

      $form.addEventListener("submit", (e) => {
        e.preventDefault();
        if (!$form.checkValidity()) {
          showAlert("Revisa los campos: completa y corrige donde falte.");
          return;
        }
        const fd = new FormData($form);
        const record = {
          id: uid(),
          nombres: (fd.get("nombres") || "").toString().trim(),
          apellidos: (fd.get("apellidos") || "").toString().trim(),
          email: (fd.get("email") || "").toString().trim(),
          telefono: (fd.get("telefono") || "").toString().trim(),
          mensaje: (fd.get("mensaje") || "").toString().trim(),
          createdAt: new Date().toISOString()
        };
        const data = getData();
        data.push(record);
        setData(data);
        $form.reset();
        renderTable($search ? $search.value : "");
        showAlert("Registro guardado.");
      });

      $tbody.addEventListener("click", (e) => {
        const btn = e.target.closest("button[data-action='delete']");
        if (!btn) return;
        const id = btn.dataset.id;
        const data = getData().filter(r => r.id !== id);
        setData(data);
        renderTable($search ? $search.value : "");
      });

      if ($btnClear) {
        $btnClear.addEventListener("click", () => {
          if (confirm("¬øEliminar todos los registros?")) {
            setData([]);
            renderTable();
          }
        });
      }

      if ($btnExport) {
        $btnExport.addEventListener("click", () => {
          const blob = new Blob([JSON.stringify(getData(), null, 2)], { type: "application/json" });
          const url = URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = "contactos.json";
          a.click();
          URL.revokeObjectURL(url);
        });
      }

      if ($search) {
        $search.addEventListener("input", (e) => renderTable(e.target.value));
      }

      renderTable();
    })();
  </script>
</body>
</html>
